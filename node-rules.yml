groups:
- name: Node.Rules
  rules:
  - alert: NodeCPUUsage
    expr: (100 - (avg by (instance) (irate(node_cpu_seconds_total{app="node-exporter",mode="idle"}[5m])) * 100)) > 75
    for: 5m
    labels: 
      severity: warning
    annotations:
      title: High CPU usage detected
      description: CPU usage is above 75% for 5m (current value is {{ $value }})
  - alert: NodeDiskRunningFull
    annotations:
      message: Device {{ $labels.device }} Mountpoint {{ $labels.mountpoint }} have low free space - {{ $value }}
    expr: node_filesystem_free_bytes/node_filesystem_size_bytes*100 < 30
    for: 30m
    labels:
      severity: warning
      #  - alert: NodeTCPRetransmitNonZero
      #expr: rate(node_netstat_Tcp_RetransSegs[1h])>0
      #for: 1h
      #labels: 
      #severity: warning
      #annotations:
      #title: There is TCP Retransmit events on node
      #description: This could be a flannel issue
